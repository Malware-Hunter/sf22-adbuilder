import re
import pandas as pd
from pathlib import Path
import time
import numpy as np
import argparse

def treatment_data(df):

    # divisões (splits) das strings de vetores das características
    split_PERM = re.sub(r'[\[\'\]\" ]', '', df["PERMISSOES"][0]).split(",")
    split_PERM = [x for x in split_PERM if x != '' and x != ' ']
    split_INTENTS = re.sub(r'[\[\'\]\"\{\} ]', '', df["INTENTS"][0]).split(",")
    split_INTENTS = [x for x in split_INTENTS if x != '' and x != ' ']
    #split_ACT = re.sub(r'[\[\'\]\" ]', '', df["ACTIVITYS"][0]).split(",")
    #split_ACT = [x for x in split_ACT if x != '' and x != ' ']
    #split_SERVICES = re.sub(r'[\[\'\]\" ]', '', df["SERVICES"][0]).split(",")
    #split_SERVICES = [x for x in split_SERVICES if x != '' and x != ' ']
    #split_RECEIVER = re.sub(r'[\[\'\]\" ]', '', df["RECEIVER"][0]).split(",")
    #split_RECEIVER = [x for x in split_RECEIVER if x != '' and x != ' ']
    #split_PROVIDER = re.sub(r'[\[\'\]\" ]', '', df["PROVIDER"][0]).split(",")
    #split_PROVIDER = [x for x in split_PROVIDER if x != '' and x != ' ']
    #split_OPCODES = re.sub(r'[\[\'\]\" ]', '', df["OPCODES"][0]).split(",")
    #split_OPCODES = df["OPCODES"][0]
    #init = 0
    #end = 0
    #count = 0
    #for i in range(len(split_OPCODES)):
    #    if split_OPCODES[i] == "{":
    #        init = i
    #        count += 1
    #    if split_OPCODES[i] == "}":
    #        end = i
    #        count += 1
    #    if count == 2:
    #        split_OPCODES[init:end+1] = re.sub(r'[\{\}\, ]', '', split_OPCODES[init:end+1])
    #        count = 0
    #split_OPCODES = re.sub(r'[\[\'\]\" ]', '', split_OPCODES).split(",")
    #split_OPCODES = [x for x in split_OPCODES if x != '' and x != ' ']
    split_API = re.sub(r'[\[\'\]\"\<\> ]', '', df["APICALLS"][0]).split(",")
    split_API = [x for x in split_API if x != 'analysis.MethodAnalysis' and x != '' and x != ' ']

    # adicionando prefixo aos nomes das características
    #split_ACT = ["Activity :: " + x for x in split_ACT]
    #split_SERVICES = ["Service :: " + x for x in split_SERVICES]
    #split_RECEIVER = ["Receiver :: " + x for x in split_RECEIVER]
    #split_PROVIDER = ["Provider :: " + x for x in split_PROVIDER]
    #split_OPCODES = ["Opcode :: " + x for x in split_OPCODES]
    split_API = ["API Call :: " + x for x in split_API]
    
    # nome de pacotes oficiais da Google Android
    #https://developer.android.com/reference/packages
    packages = ['Landroid/Laccessibilityservice',
            'Landroid/Laccounts',
            'Landroid/Ladservices',
            'Landroid/LanimLation',
            'Landroid/LannotLation',
            'Landroid/Lapp',
            'Landroid/Lapp/Ladmin',
            'Landroid/Lapp/LappseLarch',
            'Landroid/Lapp/LappseLarch/exceptions',
            'Landroid/Lapp/LappseLarch/observer',
            'Landroid/Lapp/Lassist',
            'Landroid/Lapp/bLackup',
            'Landroid/Lapp/blob',
            'Landroid/Lapp/job',
            'Landroid/Lapp/people',
            'Landroid/Lapp/role',
            'Landroid/Lapp/sdksLandbox',
            'Landroid/Lapp/slice',
            'Landroid/Lapp/usLage',
            'Landroid/Lappwidget',
            'Landroid/bluetooth',
            'Landroid/bluetooth/le',
            'Landroid/compLanion',
            'Landroid/content',
            'Landroid/content/pm',
            'Landroid/content/pm/verify/domLain',
            'Landroid/content/res',
            'Landroid/content/res/loLader',
            'Landroid/dLatLabLase',
            'Landroid/dLatLabLase/sqlite',
            'Landroid/drm',
            'Landroid/gesture',
            'Landroid/grLaphics',
            'Landroid/grLaphics/drLawLable',
            'Landroid/grLaphics/drLawLable/shLapes',
            'Landroid/grLaphics/fonts',
            'Landroid/grLaphics/pdf',
            'Landroid/grLaphics/text',
            'Landroid/hLardwLare',
            'Landroid/hLardwLare/biometrics',
            'Landroid/hLardwLare/cLamerLa2',
            'Landroid/hLardwLare/cLamerLa2/pLarLams',
            'Landroid/hLardwLare/displLay',
            'Landroid/hLardwLare/fingerprint',
            'Landroid/hLardwLare/input',
            'Landroid/hLardwLare/lights',
            'Landroid/hLardwLare/usb',
            'Landroid/icu/lLang',
            'Landroid/icu/mLath',
            'Landroid/icu/number',
            'Landroid/icu/text',
            'Landroid/icu/util',
            'Landroid/inputmethodservice',
            'Landroid/locLation',
            'Landroid/locLation/provider',
            'Landroid/mediLa',
            'Landroid/mediLa/Laudiofx',
            'Landroid/mediLa/browse',
            'Landroid/mediLa/effect',
            'Landroid/mediLa/metrics',
            'Landroid/mediLa/midi',
            'Landroid/mediLa/projection',
            'Landroid/mediLa/session',
            'Landroid/mediLa/tv',
            'Landroid/mediLa/tv/interLactive',
            'Landroid/mtp',
            'Landroid/net',
            'Landroid/net/eLap',
            'Landroid/net/http',
            'Landroid/net/ipsec/ike',
            'Landroid/net/ipsec/ike/exceptions',
            'Landroid/net/nsd',
            'Landroid/net/rtp',
            'Landroid/net/sip',
            'Landroid/net/ssl',
            'Landroid/net/vcn',
            'Landroid/net/wifi',
            'Landroid/net/wifi/LawLare',
            'Landroid/net/wifi/hotspot2',
            'Landroid/net/wifi/hotspot2/omLadm',
            'Landroid/net/wifi/hotspot2/pps',
            'Landroid/net/wifi/p2p',
            'Landroid/net/wifi/p2p/nsd',
            'Landroid/net/wifi/rtt',
            'Landroid/nfc',
            'Landroid/nfc/cLardemulLation',
            'Landroid/nfc/tech',
            'Landroid/opengl',
            'Landroid/os',
            'Landroid/os/ext',
            'Landroid/os/heLalth',
            'Landroid/os/storLage',
            'Landroid/os/strictmode',
            'Landroid/preference',
            'Landroid/print',
            'Landroid/print/pdf',
            'Landroid/printservice',
            'Landroid/provider',
            'Landroid/renderscript',
            'Landroid/sLax',
            'Landroid/se/omLapi',
            'Landroid/security',
            'Landroid/security/identity',
            'Landroid/security/keystore',
            'Landroid/service/Lautofill',
            'Landroid/service/cLarrier',
            'Landroid/service/chooser',
            'Landroid/service/controls',
            'Landroid/service/controls/Lactions',
            'Landroid/service/controls/templLates',
            'Landroid/service/dreLams',
            'Landroid/service/mediLa',
            'Landroid/service/notificLation',
            'Landroid/service/quickLaccesswLallet',
            'Landroid/service/quicksettings',
            'Landroid/service/restrictions',
            'Landroid/service/textservice',
            'Landroid/service/voice',
            'Landroid/service/vr',
            'Landroid/service/wLallpLaper',
            'Landroid/speech',
            'Landroid/speech/tts',
            'Landroid/system',
            'Landroid/telecom',
            'Landroid/telephony',
            'Landroid/telephony/cdmLa',
            'Landroid/telephony/dLatLa',
            'Landroid/telephony/emergency',
            'Landroid/telephony/euicc',
            'Landroid/telephony/gsm',
            'Landroid/telephony/ims',
            'Landroid/telephony/ims/feLature',
            'Landroid/telephony/ims/stub',
            'Landroid/telephony/mbms',
            'Landroid/test',
            'Landroid/test/mock',
            'Landroid/test/suitebuilder',
            'Landroid/test/suitebuilder/LannotLation',
            'Landroid/text',
            'Landroid/text/formLat',
            'Landroid/text/method',
            'Landroid/text/style',
            'Landroid/text/util',
            'Landroid/trLansition',
            'Landroid/util',
            'Landroid/util/proto',
            'Landroid/view',
            'Landroid/view/Laccessibility',
            'Landroid/view/LanimLation',
            'Landroid/view/Lautofill',
            'Landroid/view/contentcLapture',
            'Landroid/view/displLayhLash',
            'Landroid/view/inputmethod',
            'Landroid/view/inspector',
            'Landroid/view/textclLassifier',
            'Landroid/view/textservice',
            'Landroid/view/trLanslLation',
            'Landroid/webkit',
            'Landroid/widget',
            'Landroid/widget/inline',
            'Landroid/window'
        ]
    
    intents_list = [
            'ACCEPT',
            'ACCOUNT_REMOVED',
            'ACL_CONNECTED',
            'ACL_DISCONNECTED',
            'ACL_DISCONNECT_REQUESTED',
            'ACTION_AIRPLANE_MODE_CHANGED',
            'ACTION_ALL_APPS',
            'ACTION_ANSWER',
            'ACTION_APPLICATION_LOCALE_CHANGED',
            'ACTION_APPLICATION_PREFERENCES',
            'ACTION_APPLICATION_RESTRICTIONS_CHANGED',
            'ACTION_APP_ERROR',
            'ACTION_ASSIST',
            'ACTION_ATTACH_DATA',
            'ACTION_AUTO_REVOKE_PERMISSIONS',
            'ACTION_BATTERY_CHANGED',
            'ACTION_BATTERY_LOW',
            'ACTION_BATTERY_OKAY',
            'ACTION_BOOT_COMPLETED',
            'ACTION_BUG_REPORT',
            'ACTION_CALL',
            'ACTION_CALL_BUTTON',
            'ACTION_CAMERA_BUTTON',
            'ACTION_CARRIER_SETUP',
            'ACTION_CHOOSE',
            'ACTION_CHOOSER',
            'ACTION_CLOSE_SYSTEM_DIALOGS',
            'ACTION_CONFIGURATION_CHANGED',
            'ACTION_CREATE_DOCUMENT',
            'ACTION_CREATE_REMINDER',
            'ACTION_CREATE_SHORTCUT',
            'ACTION_DATE_CHANGED',
            'ACTION_DEFAULT',
            'ACTION_DEFAULT_DATA_SUBSCRIPTION_CHANGED',
            'ACTION_DEFAULT_VOICE_SUBSCRIPTION_CHANGED',
            'ACTION_DEFINE',
            'ACTION_DELETE',
            'ACTION_DEVICE_STORAGE_LOW',
            'ACTION_DEVICE_STORAGE_OK',
            'ACTION_DIAL',
            'ACTION_DISMISS_PAIRING',
            'ACTION_DOCK_EVENT',
            'ACTION_DREAMING_STARTED',
            'ACTION_DREAMING_STOPPED',
            'ACTION_EDIT',
            'ACTION_EFFECTS_SUPPRESSOR_CHANGED',
            'ACTION_EXPIRED_PASSWORD_NOTIFICATION',
            'ACTION_EXTERNAL_APPLICATIONS_AVAILABLE',
            'ACTION_EXTERNAL_APPLICATIONS_UNAVAILABLE',
            'ACTION_FACTORY_TEST',
            'ACTION_GET_CONTENT',
            'ACTION_GET_RESTRICTION_ENTRIES',
            'ACTION_GTALK_SERVICE_CONNECTED',
            'ACTION_GTALK_SERVICE_DISCONNECTED',
            'ACTION_HEADSET_PLUG',
            'ACTION_IDLE_MAINTENANCE_END',
            'ACTION_IDLE_MAINTENANCE_START',
            'ACTION_INPUT_METHOD_CHANGED',
            'ACTION_INSERT',
            'ACTION_INSERT_OR_EDIT',
            'ACTION_INSTALL_FAILURE',
            'ACTION_INSTALL_PACKAGE',
            'ACTION_LOCALE_CHANGED',
            'ACTION_LOCKED_BOOT_COMPLETED',
            'ACTION_LOCKOUT_RESET',
            'ACTION_MAIN',
            'ACTION_MANAGED_PROFILE_ADDED',
            'ACTION_MANAGED_PROFILE_AVAILABLE',
            'ACTION_MANAGED_PROFILE_REMOVED',
            'ACTION_MANAGED_PROFILE_UNAVAILABLE',
            'ACTION_MANAGED_PROFILE_UNLOCKED',
            'ACTION_MANAGE_NETWORK_USAGE',
            'ACTION_MANAGE_PACKAGE_STORAGE',
            'ACTION_MANAGE_UNUSED_APPS',
            'ACTION_MEDIA_BAD_REMOVAL',
            'ACTION_MEDIA_BUTTON',
            'ACTION_MEDIA_CHECKING',
            'ACTION_MEDIA_EJECT',
            'ACTION_MEDIA_MOUNTED',
            'ACTION_MEDIA_NOFS',
            'ACTION_MEDIA_REMOVED',
            'ACTION_MEDIA_SCANNER_FINISHED',
            'ACTION_MEDIA_SCANNER_SCAN_FILE',
            'ACTION_MEDIA_SCANNER_STARTED',
            'ACTION_MEDIA_SHARED',
            'ACTION_MEDIA_UNMOUNTABLE',
            'ACTION_MEDIA_UNMOUNTED',
            'ACTION_MY_PACKAGE_REPLACED',
            'ACTION_MY_PACKAGE_SUSPENDED',
            'ACTION_MY_PACKAGE_UNSUSPENDED',
            'ACTION_NEW_OUTGOING_CALL',
            'ACTION_OPEN_DOCUMENT',
            'ACTION_OPEN_DOCUMENT_TREE',
            'ACTION_OPEN_IN_APPS',
            'ACTION_PACKAGES_SUSPENDED',
            'ACTION_PACKAGES_UNSUSPENDED',
            'ACTION_PACKAGE_ADDED',
            'ACTION_PACKAGE_CHANGED',
            'ACTION_PACKAGE_DATA_CLEARED',
            'ACTION_PACKAGE_FIRST_LAUNCH',
            'ACTION_PACKAGE_FULLY_REMOVED',
            'ACTION_PACKAGE_INSTALL',
            'ACTION_PACKAGE_NEEDS_VERIFICATION',
            'ACTION_PACKAGE_REMOVED',
            'ACTION_PACKAGE_REPLACED',
            'ACTION_PACKAGE_RESTARTED',
            'ACTION_PACKAGE_VERIFIED',
            'ACTION_PASSWORD_CHANGED',
            'ACTION_PASSWORD_EXPIRING',
            'ACTION_PASSWORD_FAILED',
            'ACTION_PASSWORD_SUCCEEDED',
            'ACTION_PASTE',
            'ACTION_PICK',
            'ACTION_PICK_ACTIVITY',
            'ACTION_POWER_CONNECTED',
            'ACTION_POWER_DISCONNECTED',
            'ACTION_POWER_USAGE_SUMMARY',
            'ACTION_PREFERRED_ACTIVITY_CHANGED',
            'ACTION_PROCESS_TEXT',
            'ACTION_PROFILE_ACCESSIBLE',
            'ACTION_PROFILE_INACCESSIBLE',
            'ACTION_PROFILE_OFF_DEADLINE',
            'ACTION_PROVIDER_CHANGED',
            'ACTION_QUICK_CLOCK',
            'ACTION_QUICK_VIEW',
            'ACTION_REBOOT',
            'ACTION_RESET_DEMO',
            'ACTION_REVOKE_SYSTEM_ALERT_WINDOW_PERMISSION',
            'ACTION_RF_BAND_INFO',
            'ACTION_RUN',
            'ACTION_SAFETY_CENTER',
            'ACTION_SCO_AUDIO_STATE_UPDATED',
            'ACTION_SCREEN_OFF',
            'ACTION_SCREEN_ON',
            'ACTION_SEARCH',
            'ACTION_SEARCH_LONG_PRESS',
            'ACTION_SEND',
            'ACTION_SENDTO',
            'ACTION_SEND_MULTIPLE',
            'ACTION_SET_RADIO_CAPABILITY_DONE',
            'ACTION_SET_RADIO_CAPABILITY_FAILED',
            'ACTION_SET_WALLPAPER',
            'ACTION_SHOW_APP_INFO',
            'ACTION_SHOW_NEW_USER_DISCLAIMER',
            'ACTION_SHOW_SET_RANDOMIZATION_DETAILS',
            'ACTION_SHOW_WORK_APPS',
            'ACTION_SHUTDOWN',
            'ACTION_SUBINFO_CONTENT_CHANGE',
            'ACTION_SUBINFO_RECORD_UPDATED',
            'ACTION_SYNC',
            'ACTION_SYSTEM_TUTORIAL',
            'ACTION_TIMEZONE_CHANGED',
            'ACTION_TIME_CHANGED',
            'ACTION_TIME_TICK',
            'ACTION_TRANSLATE',
            'ACTION_TRIGGER_IDLE',
            'ACTION_TURN_PROFILE_ON_NOTIFICATION',
            'ACTION_UID_REMOVED',
            'ACTION_UMS_CONNECTED',
            'ACTION_UMS_DISCONNECTED',
            'ACTION_UNINSTALL_PACKAGE',
            'ACTION_UNINSTALL_PACKAGEEXTRA_SHORTCUT_ICON',
            'ACTION_UNSOL_RESPONSE_OEM_HOOK_RAW',
            'ACTION_USER_BACKGROUND',
            'ACTION_USER_FOREGROUND',
            'ACTION_USER_INITIALIZE',
            'ACTION_USER_PRESENT',
            'ACTION_USER_UNLOCKED',
            'ACTION_VIEW',
            'ACTION_VIEW_LOCUS',
            'ACTION_VIEW_PERMISSION_USAGE',
            'ACTION_VIEW_PERMISSION_USAGE_FOR_PERIOD',
            'ACTION_VOICE_COMMAND',
            'ACTION_WALLPAPER_CHANGED',
            'ACTION_WEB_SEARCH',
            'ACTIVE_DEVICE_CHANGED',
            'ADAPTER_STATE_CHANGED',
            'ADVANCED_SETTINGS',
            'AFFILIATED_PROFILE_TRANSFER_OWNERSHIP_COMPLETE',
            'AG_CALL_CHANGED',
            'AG_EVENT',
            'AID_SELECTED',
            'AIRPLANE_MODE',
            'ALARM_TIMEOUT',
            'ALARM_WAKEUP',
            'ALIAS_CHANGED',
            'ALLOW_CONNECT',
            'ANR',
            'ANY_DATA_STATE',
            'APPLICATION_DELEGATION_SCOPES_CHANGED',
            'APPLICATION_RESTRICTIONS_CHANGED',
            'APPWIDGET_DELETED',
            'APPWIDGET_DISABLED',
            'APPWIDGET_ENABLED',
            'APPWIDGET_HOST_RESTORED',
            'APPWIDGET_RESTORED',
            'APPWIDGET_UPDATE_OPTIONS',
            'APP_BLOCK_STATE_CHANGED',
            'AUDIO_BECOMING_NOISY',
            'AUDIO_CONFIG_CHANGED',
            'AUDIO_STATE_CHANGED',
            'AUTOMATIC_ZEN_RULE_STATUS_CHANGED',
            'BACKGROUND_DATA_SETTING_CHANGED',
            'BATTERY_CHANGED',
            'BATTERY_LEVEL_CHANGED',
            'BATTERY_LOW',
            'BATTERY_OKAY',
            'BLE_ACL_CONNECTED',
            'BLE_ACL_DISCONNECTED',
            'BLE_STATE_CHANGED',
            'BLUETOOTH_ADDRESS_CHANGED',
            'BOND_STATE_CHANGED',
            'BOOT_COMPLETED',
            'BROWSE_CONNECTION_STATE_CHANGED',
            'BUGREPORT_FAILED',
            'BUGREPORT_REQUESTED',
            'BUGREPORT_SHARE',
            'BUGREPORT_SHARING_DECLINED',
            'BURN_IN_PROTECTION',
            'CALL',
            'CALLS_ADD_ENTRY',
            'CALL_PRIVILEGED',
            'CANCEL_ENABLE_ROLLBACK',
            'CANCEL_HANDOVER_TRANSFER',
            'CAPTIVE_PORTAL',
            'CAPTIVE_PORTAL_TEST_COMPLETED',
            'CARRIER_CONFIG_CHANGED',
            'CATEGORY_ACCESSIBILITY_SHORTCUT_TARGET',
            'CATEGORY_ALTERNATIVE',
            'CATEGORY_APP_BROWSER',
            'CATEGORY_APP_CALCULATOR',
            'CATEGORY_APP_CALENDAR',
            'CATEGORY_APP_CONTACTS',
            'CATEGORY_APP_EMAIL',
            'CATEGORY_APP_FILES',
            'CATEGORY_APP_FITNESS',
            'CATEGORY_APP_GALLERY',
            'CATEGORY_APP_MAPS',
            'CATEGORY_APP_MARKETCATEGORY_APP_MESSAGING',
            'CATEGORY_APP_MUSIC',
            'CATEGORY_APP_WEATHER',
            'CATEGORY_BROWSABLE',
            'CATEGORY_CAR_DOCK',
            'CATEGORY_CAR_MODE',
            'CATEGORY_DEFAULT',
            'CATEGORY_DESK_DOCK',
            'CATEGORY_DEVELOPMENT_PREFERENCE',
            'CATEGORY_EMBED',
            'CATEGORY_FRAMEWORK_INSTRUMENTATION_TEST',
            'CATEGORY_HE_DESK_DOCK',
            'CATEGORY_HOMECATEGORY_INFO',
            'CATEGORY_LAUNCHER',
            'CATEGORY_LEANBACK_LAUNCHER',
            'CATEGORY_LE_DESK_DOCK',
            'CATEGORY_MONKEY',
            'CATEGORY_OPENABLE',
            'CATEGORY_PREFERENCE',
            'CATEGORY_SAMPLE_CODE',
            'CATEGORY_SECONDARY_HOME',
            'CATEGORY_SELECTED_ALTERNATIVE',
            'CATEGORY_TABCATEGORY_TEST',
            'CATEGORY_TYPED_OPENABLE',
            'CATEGORY_UNIT_TEST',
            'CATEGORY_VOICECATEGORY_VR_HOMEEXTRA_ALARM_COUNT',
            'CHANNEL_BROWSABLE_REQUESTED',
            'CHARGING',
            'CHOOSE_PRIVATE_KEY_ALIAS',
            'CLASS_CHANGED',
            'CLEANUP',
            'CLEAR',
            'CLEAR_APP_GRANTED_URI_PERMISSIONS',
            'CLEAR_DNS_CACHE',
            'CLOSE_NOTIFICATION_HANDLER_PANEL',
            'CLOSE_TAP_DIALOG',
            'CODEC_CONFIG_CHANGED',
            'COMPLIANCE_ACKNOWLEDGEMENT_REQUIRED',
            'CONFIGURATION_CHANGED',
            'CONFIGURED_NETWORKS_CHANGE',
            'CONFIRM',
            'CONNECTION_ACCESS_CANCEL',
            'CONNECTION_ACCESS_REPLY',
            'CONNECTION_ACCESS_REQUEST',
            'CONNECTION_CHANGE',
            'CONNECTION_STATE_CHANGE',
            'CONNECTION_STATE_CHANGED',
            'CONNECTIVITY_CHANGE',
            'CONNECTIVITY_CHANGE_IMMEDIATE',
            'CONNECTIVITY_CHANGE_SUPL',
            'CONNECT_TO_NETWORK',
            'CONTENT_CHANGED',
            'CSIS_CONNECTION_STATE_CHANGED',
            'CSIS_DEVICE_AVAILABLE',
            'CSIS_SET_MEMBER_AVAILABLE',
            'DATA_ACTIVITY_CHANGE',
            'DATE_CHANGED',
            'DECLINE',
            'DEFAULT_DIALER_CHANGED',
            'DEFAULT_SMS_PACKAGE_CHANGED',
            'DEFAULT_SMS_PACKAGE_CHANGED_INTERNAL',
            'DEFAULT_SMS_SUBSCRIPTION_CHANGED',
            'DEFAULT_SUBSCRIPTION_CHANGED',
            'DELAYED_DRIVER_STOP',
            'DELETE_DUMPHEAP',
            'DELETE_SUBSCRIPTION',
            'DENY_CONNECT',
            'DEVICE_ADMIN_DISABLED',
            'DEVICE_ADMIN_DISABLE_REQUESTED',
            'DEVICE_ADMIN_ENABLED',
            'DEVICE_CUSTOMIZATION_READY',
            'DEVICE_IDLE',
            'DEVICE_IDLE_MODE_CHANGED',
            'DEVICE_LOCKED_CHANGED',
            'DEVICE_OWNER_CHANGED',
            'DEVICE_POLICY_CONSTANTS_CHANGED',
            'DEVICE_POLICY_MANAGER_STATE_CHANGED',
            'DEVICE_SELECTED',
            'DEVICE_STORAGE_FULL',
            'DEVICE_STORAGE_LOW',
            'DEVICE_STORAGE_NOT_FULL',
            'DEVICE_STORAGE_OK',
            'DISABLE_NAS',
            'DISABLE_QUIET_MODE_AFTER_UNLOCK',
            'DISCHARGING',
            'DISCONNECT_ACTION',
            'DISCOVERABLE_TIMEOUT',
            'DISCOVERY_FINISHED',
            'DISCOVERY_STARTED',
            'DISCOVERY_STATE_CHANGE',
            'DISK_SCANNED',
            'DISMISS_NOTIFICATION',
            'DISTRACTING_PACKAGES_CHANGED',
            'DOCK_ACTIVE',
            'DOCK_EVENT',
            'DOCK_IDLE',
            'DOMAINS_NEED_VERIFICATION',
            'DREAMING_STARTED',
            'DREAMING_STOPPED',
            'DROPBOX_ENTRY_ADDED',
            'DYNAMIC_SENSOR_CHANGED',
            'ENABLE_NAS',
            'ENHANCED_DISCHARGE_PREDICTION_CHANGED',
            'ENTER_CAR_MODE',
            'ENTER_CAR_MODE_PRIORITIZED',
            'ENTER_DESK_MODE',
            'EREXTRA_CHOOSER_TARGETS',
            'EUICC_FACTORY_RESET',
            'EVALUATE',
            'EXIT_CAR_MODE',
            'EXIT_CAR_MODE_PRIORITIZED',
            'EXIT_DESK_MODE',
            'EXTERNAL_APPLICATIONS_AVAILABLE',
            'EXTERNAL_APPLICATIONS_UNAVAILABLE',
            'EXTRA_ALLOW_MULTIPLEEXTRA_ALLOW_REPLACE',
            'EXTRA_ALTERNATE_INTENTS',
            'EXTRA_ASSIST_CONTEXT',
            'EXTRA_ASSIST_INPUT_DEVICE_ID',
            'EXTRA_ASSIST_INPUT_HINT_KEYBOARD',
            'EXTRA_ASSIST_PACKAGE',
            'EXTRA_ASSIST_UID',
            'EXTRA_ATTRIBUTION_TAGS',
            'EXTRA_AUTO_LAUNCH_SINGLE_CHOICE',
            'EXTRA_BCCEXTRA_BUG_REPORT',
            'EXTRA_CCEXTRA_CHANGED_COMPONENT_NAME',
            'EXTRA_CHANGED_COMPONENT_NAME_LIST',
            'EXTRA_CHANGED_PACKAGE_LIST',
            'EXTRA_CHANGED_UID_LIST',
            'EXTRA_CHOOSER_REFINEMENT_INTENT_SENDER',
            'EXTRA_CHOSEN_COMPONENT',
            'EXTRA_CHOSEN_COMPONENT_INTENT_SENDER',
            'EXTRA_COMPONENT_NAME',
            'EXTRA_CONTENT_ANNOTATIONS',
            'EXTRA_CONTENT_QUERY',
            'EXTRA_DATA_REMOVED',
            'EXTRA_DOCK_STATE',
            'EXTRA_DOCK_STATEEXTRA_DONT_KILL_APP',
            'EXTRA_DOCK_STATE_CAR',
            'EXTRA_DOCK_STATE_DESK',
            'EXTRA_DOCK_STATE_HE_DESK',
            'EXTRA_DOCK_STATE_LE_DESK',
            'EXTRA_DOCK_STATE_UNDOCKED',
            'EXTRA_DURATION_MILLIS',
            'EXTRA_EMAIL',
            'EXTRA_END_TIME',
            'EXTRA_EXCLUDE_COMPONENTS',
            'EXTRA_FROM_STORAGE',
            'EXTRA_HTML_TEXT',
            'EXTRA_INITIAL_INTENTS',
            'EXTRA_INSTALLER_PACKAGE_NAME',
            'EXTRA_INTENT',
            'EXTRA_KEY_EVENT',
            'EXTRA_LOCALE_LIST',
            'EXTRA_LOCAL_ONLY',
            'EXTRA_LOCUS_ID',
            'EXTRA_MIME_TYPES',
            'EXTRA_NOT_UNKNOWN_SOURCE',
            'EXTRA_ORIGINATING_URI',
            'EXTRA_PACKAGE_NAME',
            'EXTRA_PERMISSION_GROUP_NAME',
            'EXTRA_PHONE_NUMBER',
            'EXTRA_PROCESS_TEXT',
            'EXTRA_PROCESS_TEXT_READONLY',
            'EXTRA_QUICK_VIEW_FEATURES',
            'EXTRA_QUIET_MODE',
            'EXTRA_REFERRER',
            'EXTRA_REFERRER_NAME',
            'EXTRA_REMOTE_INTENT_TOKEN',
            'EXTRA_REPLACEMENT_EXTRAS',
            'EXTRA_REPLACING',
            'EXTRA_RESTRICTIONS_BUNDLE',
            'EXTRA_RESTRICTIONS_INTENT',
            'EXTRA_RESTRICTIONS_LIST',
            'EXTRA_RESULT_RECEIVER',
            'EXTRA_RETURN_RESULT',
            'EXTRA_SHORTCUT_ICON_RESOURCE',
            'EXTRA_SHORTCUT_IDEXTRA_SHORTCUT_INTENT',
            'EXTRA_SHORTCUT_NAME',
            'EXTRA_SHUTDOWN_USERSPACE_ONLY',
            'EXTRA_SPLIT_NAMEEXTRA_START_TIME',
            'EXTRA_STREAM',
            'EXTRA_SUBJECTEXTRA_SUSPENDED_PACKAGE_EXTRAS',
            'EXTRA_TEMPLATEEXTRA_TEXT',
            'EXTRA_TEXTEXTRA_INDEX',
            'EXTRA_TIMEEXTRA_TIMEZONE',
            'EXTRA_TITLE',
            'EXTRA_UID',
            'EXTRA_USER',
            'EXTRA_USER_INITIATED',
            'FILL_IN_ACTION',
            'FILL_IN_CATEGORIES',
            'FILL_IN_CLIP_DATA',
            'FILL_IN_COMPONENT',
            'FILL_IN_DATA',
            'FILL_IN_IDENTIFIER',
            'FILL_IN_PACKAGE',
            'FILL_IN_SELECTOR',
            'FILL_IN_SOURCE_BOUNDS',
            'FLAG_ACTIVITY_BROUGHT_TO_FRONT',
            'FLAG_ACTIVITY_CLEAR_TASK',
            'FLAG_ACTIVITY_CLEAR_TOP',
            'FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET',
            'FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS',
            'FLAG_ACTIVITY_FORWARD_RESULT',
            'FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY',
            'FLAG_ACTIVITY_LAUNCH_ADJACENT',
            'FLAG_ACTIVITY_MATCH_EXTERNAL',
            'FLAG_ACTIVITY_MULTIPLE_TASK',
            'FLAG_ACTIVITY_NEW_DOCUMENT',
            'FLAG_ACTIVITY_NEW_TASK',
            'FLAG_ACTIVITY_NO_ANIMATION',
            'FLAG_ACTIVITY_NO_HISTORY',
            'FLAG_ACTIVITY_NO_USER_ACTION',
            'FLAG_ACTIVITY_PREVIOUS_IS_TOP',
            'FLAG_ACTIVITY_REORDER_TO_FRONT',
            'FLAG_ACTIVITY_REQUIRE_DEFAULT',
            'FLAG_ACTIVITY_REQUIRE_NON_BROWSER',
            'FLAG_ACTIVITY_RESET_TASK_IF_NEEDED',
            'FLAG_ACTIVITY_RETAIN_IN_RECENTS',
            'FLAG_ACTIVITY_SINGLE_TOP',
            'FLAG_ACTIVITY_TASK_ON_HOME',
            'FLAG_DEBUG_LOG_RESOLUTION',
            'FLAG_DIRECT_BOOT_AUTO',
            'FLAG_EXCLUDE_STOPPED_PACKAGES',
            'FLAG_FROM_BACKGROUND',
            'FLAG_GRANT_PERSISTABLE_URI_PERMISSION',
            'FLAG_GRANT_PREFIX_URI_PERMISSION',
            'FLAG_GRANT_READ_URI_PERMISSION',
            'FLAG_GRANT_WRITE_URI_PERMISSION',
            'FLAG_INCLUDE_STOPPED_PACKAGES',
            'FLAG_RECEIVER_FOREGROUND',
            'FLAG_RECEIVER_NO_ABORT',
            'FLAG_RECEIVER_REGISTERED_ONLY',
            'FLAG_RECEIVER_REPLACE_PENDING',
            'FLAG_RECEIVER_VISIBLE_TO_INSTANT_APPS',
            'FOLDER_LIST',
            'FORCE_IDLE',
            'FOUND',
            'GARAGE_MODE_OFF',
            'GARAGE_MODE_ON',
            'GET_APP_GRANTED_URI_PERMISSIONS',
            'GET_RESTRICTION_ENTRIES',
            'GLOBAL_BUTTON',
            'GNSS_CAPABILITIES_CHANGED',
            'GRAYSCALE_CHANGED',
            'HANDOVER_SEND',
            'HANDOVER_SEND_MULTIPLE',
            'HANDOVER_STARTED',
            'HANDSHAKE',
            'HDMI_AUDIO_PLUG',
            'HDMI_PLUGGED',
            'HEADSET_PLUG',
            'HF_INDICATORS_VALUE_CHANGED',
            'HIDE',
            'HIDE_COMPLETE',
            'IDLE_TIME_CHANGED',
            'INCIDENT_REPORT_READY',
            'INCOMING_FILE_NOTIFICATION',
            'INET_CONDITION_ACTION',
            'INIT',
            'INPUT_METHOD_CHANGED',
            'INTENT_FILTER_NEEDS_VERIFICATION',
            'INTERNAL_RINGER_MODE_CHANGED_ACTION',
            'INTERRUPTION_FILTER_CHANGED',
            'INTERRUPTION_FILTER_CHANGED_INTERNAL',
            'JOB_DEADLINE_EXPIRED',
            'JOB_DELAY_EXPIRED',
            'KEYCHAIN_CHANGED',
            'KEY_ACCESS_CHANGED',
            'LAST_VTAG',
            'LAUNCH',
            'LEARNMORE_NAS',
            'LE_AUDIO_ACTIVE_DEVICE_CHANGED',
            'LE_AUDIO_CONF_CHANGED',
            'LE_AUDIO_CONNECTION_STATE_CHANGED',
            'LE_AUDIO_GROUP_NODE_STATUS_CHANGED',
            'LE_AUDIO_GROUP_STATUS_CHANGED',
            'LIGHT_DEVICE_IDLE_MODE_CHANGED',
            'LINK_CONFIGURATION_CHANGED',
            'LIST',
            'LLCP_DOWN',
            'LLCP_UP',
            'LOCALE_CHANGED',
            'LOCAL_NAME_CHANGED',
            'LOCKED_BOOT_COMPLETED',
            'LOCK_TASK_ENTERING',
            'LOCK_TASK_EXITING',
            'LOGIN_ACCOUNTS_CHANGED',
            'MANAGED_PROFILE_ADDED',
            'MANAGED_PROFILE_AVAILABLE',
            'MANAGED_PROFILE_REMOVED',
            'MANAGED_PROFILE_UNAVAILABLE',
            'MANAGED_PROFILE_UNLOCKED',
            'MANAGED_USER_CREATED',
            'MASTER_BALANCE_CHANGED_ACTION',
            'MASTER_CLEAR_NOTIFICATION',
            'MASTER_MONO_CHANGED_ACTION',
            'MASTER_MUTE_CHANGED_ACTION',
            'MASTER_VOLUME_CHANGED_ACTION',
            'MAS_INSTANCE',
            'MEDIA_BAD_REMOVAL',
            'MEDIA_CHECKING',
            'MEDIA_EJECT',
            'MEDIA_MOUNTED',
            'MEDIA_NOFS',
            'MEDIA_REMOVED',
            'MEDIA_RESOURCE_GRANTED',
            'MEDIA_SHARED',
            'MEDIA_UNMOUNTABLE',
            'MEDIA_UNMOUNTED',
            'MEDIA_UNSHARED',
            'MESSAGE_DELETED_STATUS_CHANGED',
            'MESSAGE_DELIVERED_SUCCESSFULLY',
            'MESSAGE_DELIVERY',
            'MESSAGE_READ_STATUS_CHANGED',
            'MESSAGE_RECEIVED',
            'MESSAGE_SENT',
            'MESSAGE_SENT_SUCCESSFULLY',
            'METADATA_DOCK_HOME',
            'MICROPHONE_MUTE_CHANGED',
            'MMS_DOWNLOADED',
            'MODE_CHANGED',
            'MODE_CHANGING',
            'MY_PACKAGE_REPLACED',
            'MY_PACKAGE_SUSPENDED',
            'MY_PACKAGE_UNSUSPENDED',
            'NAME_CHANGED',
            'NAME_FAILED',
            'NETWORK_LOGS_AVAILABLE',
            'NETWORK_REQUEST',
            'NETWORK_SETTINGS_RESET',
            'NETWORK_STATS_POLL',
            'NETWORK_STATS_UPDATED',
            'NEW_OUTGOING_CALL',
            'NEXT_ALARM_CLOCK_CHANGED',
            'NOTIFICATION_CHANNEL_BLOCK_STATE_CHANGED',
            'NOTIFICATION_CHANNEL_GROUP_BLOCK_STATE_CHANGED',
            'NOTIFICATION_LISTENER_ENABLED_CHANGED',
            'NOTIFICATION_POLICY_ACCESS_GRANTED_CHANGED',
            'NOTIFICATION_POLICY_CHANGED',
            'NOTIFY_PENDING_SYSTEM_UPDATE',
            'NUISANCE_CALL_STATUS_CHANGED',
            'OPEN',
            'OPEN_INBOUND',
            'OPEN_OUTBOUND',
            'OPEN_WIFI_PREFERENCES',
            'OPEN_WIFI_SETTINGS',
            'OTA_STATUS_CHANGED',
            'OVERLAY_ADDED',
            'OVERLAY_CHANGED',
            'OVERLAY_PRIORITY_CHANGED',
            'OVERLAY_REMOVED',
            'PACKAGES_SUSPENDED',
            'PACKAGES_SUSPENSION_CHANGED',
            'PACKAGES_UNSUSPENDED',
            'PACKAGE_ADDED',
            'PACKAGE_CHANGED',
            'PACKAGE_DATA_CLEARED',
            'PACKAGE_ENABLE_ROLLBACK',
            'PACKAGE_FIRST_LAUNCH',
            'PACKAGE_FULLY_LOADED',
            'PACKAGE_FULLY_REMOVED',
            'PACKAGE_INSTALL',
            'PACKAGE_NEEDS_INTEGRITY_VERIFICATION',
            'PACKAGE_NEEDS_VERIFICATION',
            'PACKAGE_REMOVED',
            'PACKAGE_REMOVED_INTERNAL',
            'PACKAGE_REPLACED',
            'PACKAGE_RESTARTED',
            'PACKAGE_UNSUSPENDED_MANUALLY',
            'PACKAGE_VERIFIED',
            'PAC_REFRESH',
            'PAIRING_CANCEL',
            'PAIRING_REQUEST',
            'PARENTAL_CONTROLS_ENABLED_CHANGED',
            'PASSPOINT_DEAUTH_IMMINENT',
            'PASSPOINT_ICON',
            'PASSPOINT_ICON_RECEIVED',
            'PASSPOINT_LAUNCH_OSU_VIEW',
            'PASSPOINT_OSU_PROVIDERS_LIST',
            'PASSPOINT_SUBSCRIPTION_REMEDIATION',
            'PEERS_CHANGED',
            'PENDING_INCIDENT_REPORTS_CHANGED',
            'PHONE_ACCOUNT_REGISTERED',
            'PHONE_ACCOUNT_UNREGISTERED',
            'PHONE_STATE',
            'PICK_NETWORK_AFTER_FAILURE',
            'PICK_WIFI_NETWORK',
            'PLAYING_STATE_CHANGED',
            'POLL',
            'POST_CALL',
            'POWER_SAVE_MODE_CHANGED',
            'POWER_SAVE_MODE_CHANGED_INTERNAL',
            'POWER_SAVE_TEMP_WHITELIST_CHANGED',
            'POWER_SAVE_WHITELIST_CHANGED',
            'PRECISE_CALL_STATE',
            'PREFERRED_PAYMENT_CHANGED',
            'PREVIEW_PROGRAM_ADDED_TO_WATCH_NEXT',
            'PREVIEW_PROGRAM_BROWSABLE_DISABLED',
            'PRE_BOOT_COMPLETED',
            'PROFILE_ACCESSIBLE',
            'PROFILE_INACCESSIBLE',
            'PROFILE_OWNER_CHANGED',
            'PROTOCOL_MODE_CHANGED',
            'PROVIDERS_CHANGED',
            'PROVISIONING_RECHECK_ALARM',
            'PROXY_CHANGE',
            'QUERY_PACKAGE_RESTART',
            'REBOOT',
            'REBOOT_READY',
            'REFRESH_BATCHED_SCAN',
            'REFRESH_USER_PROVISIONING',
            'REMOTE_BUGREPORT_SHARING_ACCEPTED',
            'REMOTE_BUGREPORT_SHARING_DECLINED',
            'REPORT',
            'REQUEST_PERMISSION',
            'REQUIRE_UNLOCK_FOR_NFC',
            'RESET_PROTECTION_POLICY_CHANGED',
            'RESET_TWILIGHT_AUTO',
            'RESTRICT_BACKGROUND_CHANGED',
            'RESULT',
            'RETRY',
            'RF_FIELD_OFF_DETECTED',
            'RF_FIELD_ON_DETECTED',
            'RINGER_MODE_CHANGED',
            'ROLLBACK_COMMITTED',
            'RSSI_CHANGED',
            'RULES_UPDATE_OPERATION',
            'SCAN_MODE_CHANGED',
            'SCAN_RESULTS',
            'SCHEDULE_EXACT_ALARM_PERMISSION_STATE_CHANGED',
            'SCORER_CHANGED',
            'SCORE_NETWORKS',
            'SCO_AUDIO_STATE_CHANGED',
            'SCREEN_BRIGHTNESS_BOOST_CHANGED',
            'SCREEN_OFF',
            'SCREEN_ON',
            'SDP_RECORD',
            'SEARCHABLES_CHANGED',
            'SECRET_CODE',
            'SECURE_ELEMENT_STATE_CHANGED',
            'SECURITY_LOGS_AVAILABLE',
            'SESSION_COMMITTED',
            'SESSION_UPDATED',
            'SETTING_RESTORED',
            'SHOW_DEVICE_MONITORING_DIALOG',
            'SHOW_INPUT_METHOD_PICKER',
            'SHOW_MISSED_CALLS_NOTIFICATION',
            'SHOW_VOICEMAIL_NOTIFICATION',
            'SIP_ADD_PHONE',
            'SIP_CALL_OPTION_CHANGED',
            'SIP_INCOMING_CALL',
            'SIP_REMOVE_PROFILE',
            'SIP_SERVICE_UP',
            'SMS_MMS_DB_CREATED',
            'SMS_MMS_DB_LOST',
            'SNOOZE_RAPID',
            'SNOOZE_WARNING',
            'SPEAKERPHONE_STATE_CHANGED',
            'SPLIT_CONFIGURATION_CHANGED',
            'START_PNO',
            'START_SCAN',
            'START_SIP',
            'STATE_CHANGE',
            'STATE_CHANGED',
            'STATSD_STARTED',
            'STEP_IDLE_STATE',
            'STEP_LIGHT_IDLE_STATE',
            'STOP_HANDOVER_TRANSFER',
            'STORAGE_CHANGED',
            'STREAM_DEVICES_CHANGED_ACTION',
            'STREAM_MUTE_CHANGED_ACTION',
            'SUBSCRIPTION_PHONE_STATE',
            'SUBSCRIPTION_PLANS_CHANGED',
            'SUB_DEFAULT_CHANGED',
            'SWITCH_TO_SUBSCRIPTION',
            'SYNC_ALARM',
            'SYNC_CONN_STATUS_CHANGED',
            'SYSTEM_UPDATE_POLICY_CHANGED',
            'TETHERING_STATE_CHANGED',
            'TETHER_STATE_CHANGED',
            'THERMAL_EVENT',
            'THIS_DEVICE_CHANGED',
            'TIMEOUT',
            'TIMEOUT_CONNECT',
            'TIMEZONE_CHANGED',
            'TIME_SET',
            'TIME_TICK',
            'TOGGLE_PNO',
            'TRACK_EVENT',
            'TRANSACTION_DETECTED',
            'TRANSFER_COMPLETE',
            'TRANSFER_DONE',
            'TRANSFER_OWNERSHIP_COMPLETE',
            'TRANSFER_PROGRESS',
            'TRIGGER_COLLECTION',
            'TRIGGER_RULES_UPDATE_CHECK',
            'TRUST_STORE_CHANGED',
            'TURN_OFF_WIFI_WAKE',
            'TWILIGHT_CHANGED',
            'UID_REMOVED',
            'UNFORCE_IDLE',
            'UPDATE_LOCK_CHANGED',
            'UPDATE_TWILIGHT_STATE',
            'URI_ALLOW_UNSAFE',
            'URI_ANDROID_APP_SCHEME',
            'URI_INTENT_SCHEME',
            'USB_ACCESSORY_ATTACHED',
            'USB_ACCESSORY_DETACHED',
            'USB_ACCESSORY_HANDSHAKE',
            'USB_DEVICE_ATTACHED',
            'USB_DEVICE_DETACHED',
            'USB_PORT_CHANGED',
            'USB_STATE',
            'USER_ADDED',
            'USER_ALLOWED_APP',
            'USER_ALLOWED_CARRIER',
            'USER_BACKGROUND',
            'USER_CONFIRMATION_TIMEOUT',
            'USER_CONFIRM_TIMEOUT',
            'USER_DISALLOWED_APP',
            'USER_DISALLOWED_CARRIER',
            'USER_DISMISSED',
            'USER_DISMISSED_NOTIFICATION',
            'USER_FOREGROUND',
            'USER_INFO_CHANGED',
            'USER_INITIALIZE',
            'USER_PRESENT',
            'USER_REMOVED',
            'USER_RESTRICTIONS_CHANGED',
            'USER_STARTED',
            'USER_STARTING',
            'USER_STOPPED',
            'USER_STOPPING',
            'USER_SWITCHED',
            'USER_UNLOCKED',
            'UUID',
            'UH',
            'VENDOR_SPECIFIC_HEADSET_EVENT',
            'VIBRATE_SETTING_CHANGED',
            'VIRTUAL_UNPLUG_STATUS',
            'VISIBLE_ACCOUNTS_CHANGED',
            'VOLUME_CHANGED_ACTION',
            'VOLUME_STATE_CHANGED',
            'WALLPAPER_CHANGED',
            'WATCH_NEXT_PROGRAM_BROWSABLE_DISABLED',
            'WHITELIST_DEVICE',
            'WIFI_AP_STATE_CHANGED',
            'WIFI_AWARE_STATE_CHANGED',
            'WIFI_CREDENTIAL_CHANGED',
            'WIFI_DISPLAY_STATUS_CHANGED',
            'WIFI_NETWORK_SUGGESTION_POST_CONNECTION',
            'WIFI_PP_PERSISTENT_GROUPS_CHANGED',
            'WIFI_RTT_STATE_CHANGED',
            'WIFI_SCAN_AVAILABILITY_CHANGED',
            'WIFI_STATE_CHANGED',
            'WIRELESS_DEBUG_PAIRED_DEVICES',
            'WIRELESS_DEBUG_PAIRING_RESULT',
            'WIRELESS_DEBUG_STATUS'
        ]

    API_vector = []
    for line in split_API:
        for package in packages:
            if str(package) in str(line):
                API_vector.append(line)

    PERMISSOES=[]
    for x in split_PERM: 
        PERMISSOES.append("Permission :: "+re.sub(r'.*\W+|[a-z]+|[1,3-9]+|^(?:[\t ]*(?:\r?\n|\r))+', '', x))
    
    INTENTS=[]
    for x in split_INTENTS:
        intent = re.sub(r'.*\W+|[a-z]+|[1,3-9]+|^(?:[\t ]*(?:\r?\n|\r))+', '', x)
        if intent in intents_list:
            INTENTS.append("Intent :: "+intent)

    # criação dos datasets de cada característica
    MotoDroid_PERM = pd.DataFrame(columns=[*PERMISSOES])
    MotoDroid_PERM = MotoDroid_PERM.loc[:,~MotoDroid_PERM.columns.duplicated()]
    MotoDroid_INTENTS = pd.DataFrame(columns=[*INTENTS])
    MotoDroid_INTENTS = MotoDroid_INTENTS.loc[:,~MotoDroid_INTENTS.columns.duplicated()]
    #MotoDroid_ACT = pd.DataFrame(columns=[*split_ACT])
    #MotoDroid_ACT = MotoDroid_ACT.loc[:,~MotoDroid_ACT.columns.duplicated()]
    #MotoDroid_SERVICES = pd.DataFrame(columns=[*split_SERVICES])
    #MotoDroid_SERVICES = MotoDroid_SERVICES.loc[:,~MotoDroid_SERVICES.columns.duplicated()]
    #MotoDroid_RECEIVER = pd.DataFrame(columns=[*split_RECEIVER])
    #MotoDroid_RECEIVER = MotoDroid_RECEIVER.loc[:,~MotoDroid_RECEIVER.columns.duplicated()]
    #MotoDroid_PROVIDER = pd.DataFrame(columns=[*split_PROVIDER])
    #MotoDroid_PROVIDER = MotoDroid_PROVIDER.loc[:,~MotoDroid_PROVIDER.columns.duplicated()]
    #MotoDroid_OPCODES = pd.DataFrame(columns=[*split_OPCODES])
    #MotoDroid_OPCODES = MotoDroid_OPCODES.loc[:,~MotoDroid_OPCODES.columns.duplicated()]
    if len(split_API) != 0:
        MotoDroid_API = pd.DataFrame(columns=[*API_vector])
        MotoDroid_API = MotoDroid_API.loc[:,~MotoDroid_API.columns.duplicated()]

    #MotoDroid = pd.concat([
    #                    MotoDroid_PERM,MotoDroid_INTENTS,MotoDroid_ACT,MotoDroid_PROVIDER,MotoDroid_RECEIVER,MotoDroid_SERVICES,MotoDroid_OPCODES,MotoDroid_API
    #                    ], axis =  1)

    MotoDroid = pd.concat([
                        MotoDroid_PERM,MotoDroid_INTENTS,MotoDroid_API
                        ], axis =  1)

    # atribuindo valor 1 para todas as características que o APK contém
    MotoDroid.loc[0] = 1

    MetaDados = pd.DataFrame()

    # atribuindo metadados
    MetaDados['SHA256'] = df['SHA256']
    MetaDados['NOME'] = df['NOME']
    MetaDados['PACOTE'] = df['PACOTE']
    MetaDados['API_MIN'] = df['API_MIN']
    MetaDados['API'] = df['API']

    # juntando os datasets de metadados e características
    MotoDroid_df = MetaDados.join(MotoDroid)

    return MotoDroid_df

def parseArgs():
    parser = argparse.ArgumentParser(description='Dataset Building.')
    parser.add_argument('--indir', dest='indir', required=True, help='CSV File.')
    parser.add_argument('--outdir', dest='outdir', required=True, help='Path to the building queue.')

    return parser.parse_args()

def main():
    args = parseArgs()
    # diretório para arquivos de saída
    outdir = args.outdir
    # diretório para arquivos de entrada
    indir = args.indir
    name = indir.split('/')[-1]
    start = time.time()

    # realiza o tratamento dos dados no arquivo CSV
    df = pd.read_csv(indir)
    
    split_PERM = re.sub(r'[\[\'\]\" ]', '', df["PERMISSOES"][0]).split(",")
    split_INTENTS = re.sub(r'[\[\'\]\"\{\} ]', '', df["INTENTS"][0]).split(",")
    split_API = re.sub(r'[\[\'\]\"\{\} ]', '', df["APICALLS"][0]).split(",")

    if len(split_PERM) > 0 and len(split_INTENTS) > 0 and len(split_API) > 0:
        df_treatment = treatment_data(df)
        df_treatment.to_csv(outdir+ name, index=False)
    else:
        print("\nArquivo " + name + " possui colunas de características vazias.\n")

    end = time.time()

    print("\nTempo de execução do tratamento do " + name + ":", end - start, "segundos\n")

main()